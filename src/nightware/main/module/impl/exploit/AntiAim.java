package nightware.main.module.impl.exploit;

import com.darkmagician6.eventapi.EventTarget;
import nightware.main.NightWare;
import nightware.main.event.player.EventUpdate;
import nightware.main.module.Category;
import nightware.main.module.Module;
import nightware.main.module.ModuleAnnotation;
import nightware.main.module.impl.combat.AimBot;
import nightware.main.module.setting.impl.ModeSetting;
import nightware.main.module.setting.impl.NumberSetting;
import nightware.main.utility.math.GCDFixUtility;
import nightware.main.utility.math.MathUtility;
import org.lwjgl.input.Mouse;

@ModuleAnnotation(
        name = "AntiAim",
        category = Category.EXPLOIT
)
public class AntiAim extends Module {
    float rotation = 0;
    float rotationp = 0;
    public static ModeSetting antiAimsMode = new ModeSetting("Режим", "Spin", "Spin", "Backwards");
    public static NumberSetting speed = new NumberSetting("Скорость", 50, 10, 150, 1);
    public AntiAim() {
        super();
        speed.setVisible(() -> antiAimsMode.is("Spin"));
    }

    @EventTarget
    public void onUpdate(EventUpdate event) {
        boolean can = (NightWare.getInstance().getModuleManager().getModule(AimBot.class).isEnabled() ? !AimBot.work : true);
        if (can) {
            if (!(Mouse.isButtonDown(0) || Mouse.isButtonDown(1))) {
                if (antiAimsMode.is("Spin")) {
                    event.setRotationYaw(rotation);
                    event.setRotationPitch(rotationp);
                    mc.player.rotationYawHead = rotation;
                    mc.player.renderYawOffset = rotation;
                    mc.player.rotationPitchHead = rotationp;
                    rotation += speed.get();
                    if (rotation > 180) {
                        rotation = -180;
                    }
                    rotationp += (speed.get() / 2);
                    if (rotation > 180) {
                        rotationp = -180;
                    }
                } else if (antiAimsMode.is("Backwards")) {
                    /*float yaw = (float) (mc.player.rotationYaw + Math.random() * 220);
                    event.setRotationYaw(GCDFixUtility.getFixedRotation(yaw));
                    mc.player.renderYawOffset = yaw;
                    mc.player.rotationYawHead = yaw;*/

                    float yaw = mc.player.rotationYaw + 180 + (mc.player.ticksExisted % 8 < 4 ? MathUtility.randomizeFloat(-90, 90) : -MathUtility.randomizeFloat(90, -90));
                    event.setRotationYaw(GCDFixUtility.getFixedRotation(yaw));
                    mc.player.renderYawOffset = yaw;
                    mc.player.rotationYawHead = yaw;
                    mc.player.rotationPitchHead = -90;
                }
            }
        }
    }
}

